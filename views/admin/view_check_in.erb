<h1> Check In Viewer </h1>


<div style="padding-top: 25px">
    <h3> Number of Members going to each studio in the past 7 days </h3>
    <table class="dcf-w-100% dcf-table dcf-table-bordered dcf-table-responsive" aria-label="Heat Map">
        <thead>
            <tr>
                <% studios.each do |studio| %>
                    <th><%= studio %></th>
                <% end %>
            </tr>
        </thead>
        <tbody>
            <tr>
                <% studios.each do |studio| %>
                    <th><%= counts[studio] || 0 %></th>
                <% end %>
            </tr>
        </tbody>
    </table>
</div>

<form class="dcf-form dcf-mb-6" id="find-controls">
    <div class="dcf-grid dcf-col-gap-vw dcf-row-gap-6">
        <div class="dcf-col-100% dcf-col-25%-start@md">
            <label>Find users by:</label>
            <br>
            <a href="/admin/users/" class="dcf-btn dcf-btn-secondary">Clear</a>
        </div>
        <div class="dcf-col-100% dcf-col-75%-end@md">
            <div class="dcf-grid-full dcf-grid-halves@sm dcf-col-gap-vw">
                <div>
                    <label for="name">Name:</label>
                    <input id="name" tabindex="1" type="text" name="name" value="<%= name != "" ? name : "" %>" style="width:100%;" />
                    <input type="hidden" name="hidden-first-name" id="hidden-first-name" value="<%= name %>">
                </div>
                <div>
                    <label for="studio-status">Studio Status:</label>
                    <select id="studio-status" tabindex="1" name="studio_status" class="dcf-input-select">
                        <option value=""></option>
                        <% USER_STATII.each do |word| %>
                            <option <%= 'selected="selected"' if studio_status == word %> value="<%= word %>"><%= word %></option>
                        <% end %>
                    </select>
                    <input type="hidden" name="hidden-studio-status" id="hidden-studio-status" value="<%= studio_status %>">
                </div>
                <div>
                    <label for="expiration-date">Expiration Date:</label>
                    <div class="dcf-grid dcf-col-gap-1 dcf-row-gap-2 dcf-flex-wrap">
                        <div class="dcf-col-100% dcf-col-33%-start@sm">
                            <select id="expiration-date-operation" tabindex="1" name="expiration_date_operation" class="dcf-input-select">
                                <option value=""></option>
                                <% EXPIRATION_DATE_SEARCH_OPERATIONS.each_with_index do |operation, value| %>
                                    <option <%= 'selected="selected"' if expiration_date_operation.to_i == (value + 1) %> value="<%= value + 1 %>"><%= operation %></option>
                                <% end %>
                            </select>
                            <input type="hidden" name="hidden-expiration-date-operation" id="hidden-expiration-date-operation" value="<%= expiration_date_operation %>">
                        </div>
                        <div class="dcf-col-100% dcf-col-67%-end@sm">
                            <div class="dcf-datepicker">
                                <input id="expiration-date" tabindex="1" value="<%= expiration_date != "" ? expiration_date : "" %>" name="expiration_date" title="Expiration Date" type="text"  style="width:100%;"/>
                            </div>
                            <input type="hidden" name="hidden-expiration-date" id="hidden-expiration-date" value="<%= expiration_date %>">
                        </div>
                    </div>
                </div>
            </div>
            <button id="search-btn" tabindex="1" class="dcf-btn dcf-btn-inverse-primary" style="margin-top:10px;">Search</button>
        </div>
    </div>
</form>

<div style="padding-top: 25px">
    <h3> Check In Log </h3>
    <table class="dcf-w-100% dcf-table dcf-table-bordered dcf-table-responsive" aria-label="Check Ins">
        <thead>
            <tr>
                <th scope="col">Check In Time</th>
                <th scope="col">Name</th>
                <th scope="col">Username</th>
                <th scope="col">University Status</th>
                <th scope="col">Visit Reason</th>
                <th scope="col">Studio Used</th>
                <th scope="col">Is Member Expired?</th>
                <th scope="col">Actions</th>
            </tr>
        </thead>
        <tbody>
            <% checkIns.each do |checkIn| %>
                <tr>
                    <td>
                        <%= checkIn.datetime.in_time_zone.strftime('%m/%d/%Y %H:%M %p') %>
                    </td>
                    <td>
                        <%= checkIn.name %><br>
                    </td>
                    <td>
                        <%= checkIn.username %>
                    </td>
                    <td>
                        <%= checkIn.university_status %>
                    </td>
                    <td>
                        <%= checkIn.visit_reason %>
                    </td>
                    <td>
                        <%= checkIn.studio_used %>
                    </td>
                    <td>
                        <%= checkIn.expired %>
                    </td>
                    <td class="table-actions">
                        <a href="/admin/users/<%= checkIn.user_id %>/edit/" class="dcf-mt-1 dcf-btn dcf-btn-primary">Edit</a>
                    </td>
                </tr>
            <% end %>
        </tbody>
    </table>
</div>